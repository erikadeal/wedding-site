/*!CK:3959142624!*//*1417408006,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["wyhW8"]); }

__d("MissedVideoCallHandler",["AsyncRequest","Dialog","VideoCallSupport"],function(a,b,c,d,e,f,g,h,i){var j={_missedCallDialog:null,_shouldSuppressMissedCallDialogs:false,onMissedCall:function(k,l){if(!i.isVideoCallSupported()||this._shouldSuppressMissedCallDialogs)return;var m='/ajax/chat/video/missed_call.php?idTarget='+k.from,n=new h().setAsync(new g(m));if(l){this._missedCallDialog=n;}else{n.show();this._shouldSuppressMissedCallDialogs=true;}},showDialog:function(){if(!!this._missedCallDialog){this._missedCallDialog.show();this._shouldSuppressMissedCallDialogs=true;}},resetDialog:function(){this._missedCallDialog=null;},setSuppressAll:function(k){this._shouldSuppressMissedCallDialogs=k;}};e.exports=j;},null);
__d("FBRTCConstants",[],function(a,b,c,d,e,f){var g={OFFER:'offer',ANSWER:'answer',ICE_CANDIDATE:'ice_candidate',OK:'ok',HANGUP:'hang_up',OTHER_DISMISS:'other_dismiss',MSG_ACK:'msg_ack',PRANSWER:'pranswer',ICERESTART_OFFER:'icerestart_offer',ICERESTART_ANSWER:'icerestart_answer',OFFER_ACK:'offer_ack',OFFER_NACK:'offer_nack',ANSWER_ACK:'answer_ack',SET_VIDEO:'set_video'},h={IGNORE_CALL:0,HANGUP_CALL:1,IN_ANOTHER_CALL:2,ACCEPT_AFTER_HANGUP:3,NO_ANSWER_TIMEOUT:4,INCOMING_TIMEOUT:5,OTHER_INSTANCE_HANDLED:6,SIGNALING_MESSAGE_FAILED:7,CONNECTION_DROPPED:8,CLIENT_INTERRUPTED:9,WEBRTC_ERROR:10,CLIENT_ERROR:11,NO_PERMISSION:12,OTHER_NOT_CAPABLE:13,NO_UI_ERROR:14,UNSUPPORTED_VERSION:15,CALLER_NOT_VISIBLE:16,CARRIER_BLOCKED:17,OTHER_CARRIER_BLOCKED:18},i={};i[h.IGNORE_CALL]='IgnoreCall';i[h.HANGUP_CALL]='HangupCall';i[h.IN_ANOTHER_CALL]='InAnotherCall';i[h.ACCEPT_AFTER_HANGUP]='CallEndAcceptAfterHangUp';i[h.NO_ANSWER_TIMEOUT]='NoAnswerTimeout';i[h.INCOMING_TIMEOUT]='IncomingTimeout';i[h.OTHER_INSTANCE_HANDLED]='OtherInstanceHandled';i[h.SIGNALING_MESSAGE_FAILED]='SignalingMessageFailed';i[h.CONNECTION_DROPPED]='ConnectionDropped';i[h.CLIENT_INTERRUPTED]='ClientInterrupted';i[h.WEBRTC_ERROR]='WebRTCError';i[h.CLIENT_ERROR]='ClientError';i[h.NO_PERMISSION]='NoPermission';i[h.OTHER_NOT_CAPABLE]='OtherNotCapable';i[h.NO_UI_ERROR]='NoUIShown';i[h.UNSUPPORTED_VERSION]='VersionUnsupported';i[h.CALLER_NOT_VISIBLE]='CallerNotVisible';i[h.CARRIER_BLOCKED]='CarrierBlocked';i[h.OTHER_CARRIER_BLOCKED]='OtherCarrierBlocked';var j={HANG_UP:1,TOGGLE_MUTE_AUDIO:2,TOGGLE_MUTE_VIDEO:3,TOGGLE_FULL_SCREEN:4,TOGGLE_SELF_VIEW:5,SUBMIT_STAR_RATING:6,SUBMIT_FEEDBACK:7},k={PayloadType:g,CallEndReason:h,UIEventType:j,callEndReasonString:function(l){var m=i[l]||'Unknown';return m;},fullCallEndReasonString:function(l,m){return this.callEndReasonString(l)+'_'+(m?'remote':'local');}};e.exports=k;},null);
__d("FBRTCIceStatsParser",[],function(a,b,c,d,e,f){var g=null;h.getInstance=function(){"use strict";if(!g)g=new h();return g;};function h(){"use strict";}h.prototype.extractIceInfo=function(i){"use strict";var j=[],k=i.split("\r\n");for(var l=0;l<k.length;l++){var m=k[l];if(this.$FBRTCIceStatsParser0(m))j.push({gen:this.$FBRTCIceStatsParser1(m),type:this.$FBRTCIceStatsParser2(m)});}return j;};h.prototype.$FBRTCIceStatsParser0=function(i){"use strict";return (i.indexOf('candidate:')>-1);};h.prototype.$FBRTCIceStatsParser1=function(i){"use strict";var j=0,k=i.match(/generation (\d+)/);if(k)j=parseInt(k[1],10);return j;};h.prototype.$FBRTCIceStatsParser2=function(i){"use strict";var j=i.match(/typ (host|relay|srflx|prflx)/);if(j){return j[1];}else return 'unknown';};e.exports=h;},null);
__d("FBRTCCallSummary",["FBRTCConstants","FBRTCIceStatsParser","FBRTCLogger","UserAgentData","copyProperties"],function(a,b,c,d,e,f,g,h,i,j,k){var l={CALL_STARTED:'started',POPUP_OPENED:'opened',SENT_OFFER:'s_o',RECV_OFFER:'r_o',SENT_OFFER_ACK:'s_oack',RECV_OFFER_ACK:'r_oack',SENT_RETRIED_OFFER:'s_o2',RECV_RETRIED_OFFER:'r_o2',SENT_RETRIED_OFFER_ACK:'s_oack2',RECV_RETRIED_OFFER_ACK:'r_oack2',SENT_PRANSWER:'s_pr',RECV_PRANSWER:'r_pr',NETWORK_READY:'network_ready',SENT_ANSWER:'s_a',RECV_ANSWER:'r_a',SENT_ANSWER_ACK:'s_aack',RECV_ANSWER_ACK:'r_aack',SENT_RETRIED_ANSWER:'s_a2',RECV_RETRIED_ANSWER:'r_a2',SENT_RETRIED_ANSWER_ACK:'s_aack2',RECV_RETRIED_ANSWER_ACK:'r_aack2',SENT_OK:'s_ok',RECV_OK:'r_ok',CALL_CONNECTED:'connected',CALL_ENDED:'ended'};m.CURRENT_SUMMARY_VERSION=10;function m(n){"use strict";this.peerID=n.peerID;this.callID=n.callID;this.$FBRTCCallSummary0=n.isCaller;this.$FBRTCCallSummary1=(new Date()).valueOf();this.$FBRTCCallSummary2=null;this.$FBRTCCallSummary3={};this.$FBRTCCallSummary4=null;this.$FBRTCCallSummary5=null;this.$FBRTCCallSummary6=null;this.$FBRTCCallSummary7=null;this.$FBRTCCallSummary8=null;this.$FBRTCCallSummary9=null;this.$FBRTCCallSummarya={};this.$FBRTCCallSummaryb={};this.$FBRTCCallSummaryc={};this.$FBRTCCallSummaryd={};this.$FBRTCCallSummarye={};this.$FBRTCCallSummaryf=0;this.$FBRTCCallSummaryg={};this.addExtraInfo(i.Key.DEVICE_INFO,this.$FBRTCCallSummaryh());this.$FBRTCCallSummaryi();this.$FBRTCCallSummaryj=h.getInstance();}m.prototype.toJsonString=function(){"use strict";this.$FBRTCCallSummary8=(new Date()).valueOf();return JSON.stringify({version:m.CURRENT_SUMMARY_VERSION,peerID:this.peerID,callID:this.callID,isCaller:this.$FBRTCCallSummary0,startTime:this.$FBRTCCallSummary1,trigger:this.$FBRTCCallSummary2,signalingTime:this.$FBRTCCallSummary3,endCallReason:this.$FBRTCCallSummary4,endCallSubreason:this.$FBRTCCallSummary5,isRemoteEnded:this.$FBRTCCallSummary6,lastUpdatedTime:this.$FBRTCCallSummary7,lastSerializedTime:this.$FBRTCCallSummary8,unsetOnRetrieve:this.$FBRTCCallSummary9,openCount:this.$FBRTCCallSummaryf,extraInfo:this.$FBRTCCallSummaryg,pcStats:this.$FBRTCCallSummarya,gen0IceSentCount:this.$FBRTCCallSummaryb,gen0IceReceivedCount:this.$FBRTCCallSummaryc,iceSentCount:this.$FBRTCCallSummaryd,iceReceivedCount:this.$FBRTCCallSummarye});};m.fromJsonString=function(n){"use strict";var o;try{o=JSON.parse(n);}catch(p){return null;}if(o.version!==m.CURRENT_SUMMARY_VERSION)return null;if(!o.hasOwnProperty('peerID')||!o.hasOwnProperty('callID')||!o.hasOwnProperty('isCaller')||!o.hasOwnProperty('startTime')||!o.hasOwnProperty('trigger')||!o.hasOwnProperty('signalingTime')||!o.hasOwnProperty('endCallReason')||!o.hasOwnProperty('isRemoteEnded')||!o.hasOwnProperty('lastUpdatedTime')||!o.hasOwnProperty('lastSerializedTime'))return null;var q=new m({peerID:o.peerID,callID:o.callID,isCaller:o.isCaller});q.$FBRTCCallSummary1=o.startTime;q.$FBRTCCallSummary2=o.trigger;q.$FBRTCCallSummary3=o.signalingTime;q.$FBRTCCallSummary4=o.endCallReason;q.$FBRTCCallSummary5=o.endCallSubreason;q.$FBRTCCallSummary6=o.isRemoteEnded;q.$FBRTCCallSummary7=o.lastUpdatedTime;q.$FBRTCCallSummary8=o.lastSerializedTime;if(o.unsetOnRetrieve)q.$FBRTCCallSummary9=o.unsetOnRetrieve;if(o.openCount)q.$FBRTCCallSummaryf=o.openCount;if(o.extraInfo)q.$FBRTCCallSummaryg=o.extraInfo;if(o.pcStats)q.$FBRTCCallSummarya=o.pcStats;if(o.gen0IceSentCount)q.$FBRTCCallSummaryb=o.gen0IceSentCount;if(o.gen0IceReceivedCount)q.$FBRTCCallSummaryc=o.gen0IceReceivedCount;if(o.iceSentCount)q.$FBRTCCallSummaryd=o.iceSentCount;if(o.iceReceivedCount)q.$FBRTCCallSummarye=o.iceReceivedCount;return q;};m.restoreOrInitialize=function(n,o,p,q,r){"use strict";var s=n.retrieveCallSummary(o,p);if(!s){s=new m({peerID:o,callID:p,isCaller:q});if(r){s.onMessageTypeReceived(r);s.onOfferAckSent(r);}else s.onCallStarted(i.Trigger.UNKNOWN);i.getInstance().logError(o,p,'Missing call summary from storage');}else if(s.$FBRTCCallSummary9){s.$FBRTCCallSummary4=null;s.$FBRTCCallSummary5=null;s.$FBRTCCallSummary6=null;delete s.$FBRTCCallSummary3[l.CALL_ENDED];s.$FBRTCCallSummary9=null;}return s;};m.logSavedSummaries=function(n){"use strict";var o=n.getLoggableSummaries(),p=o.length;if(p<=0)return;var q=i.getInstance(),r=[];for(var s=0;s<p;s++){var t=o[s];q.logEndCallSummary(t);r.push({peerID:t.peerID,callID:t.callID});}n.removeCallSummaries(r);q.logToConsole('Logged pending summaries: '+p);};m.prototype.save=function(n){"use strict";n.storeCallSummary(this.peerID,this.callID,this);};m.prototype.getLastUpdatedTime=function(){"use strict";return this.$FBRTCCallSummary7;};m.prototype.setLastUpdatedTime=function(n){"use strict";this.$FBRTCCallSummary7=n;};m.prototype.getExtraInfo=function(){"use strict";return this.$FBRTCCallSummaryg;};m.prototype.addExtraInfo=function(n,o){"use strict";this.$FBRTCCallSummaryg[n]=o;this.$FBRTCCallSummaryi();};m.prototype.onCallStarted=function(n){"use strict";this.$FBRTCCallSummary2=n;this.$FBRTCCallSummaryk(l.CALL_STARTED);this.$FBRTCCallSummaryi();};m.prototype.onPopupOpened=function(){"use strict";this.$FBRTCCallSummaryk(l.POPUP_OPENED);this.$FBRTCCallSummaryf++;this.$FBRTCCallSummaryi();};m.prototype.setPcStats=function(n){"use strict";this.$FBRTCCallSummarya=n;this.$FBRTCCallSummaryi();};m.prototype.onOfferAckSent=function(n){"use strict";this.onMessageTypeSent({type:g.PayloadType.OFFER_ACK,flag:n.flag});};m.prototype.onMessageTypeSent=function(n){"use strict";var o=n.flag===1;switch(n.type){case g.PayloadType.OFFER:this.$FBRTCCallSummaryl(o,l.SENT_OFFER,l.SENT_RETRIED_OFFER);this.$FBRTCCallSummarym(n,this.$FBRTCCallSummaryb,this.$FBRTCCallSummaryd);break;case g.PayloadType.ANSWER:this.$FBRTCCallSummaryl(o,l.SENT_ANSWER,l.SENT_RETRIED_ANSWER);this.$FBRTCCallSummarym(n,this.$FBRTCCallSummaryb,this.$FBRTCCallSummaryd);break;case g.PayloadType.OK:this.$FBRTCCallSummaryk(l.SENT_OK);break;case g.PayloadType.PRANSWER:this.$FBRTCCallSummaryk(l.SENT_PRANSWER);break;case g.PayloadType.OFFER_ACK:this.$FBRTCCallSummaryl(o,l.SENT_OFFER_ACK,l.SENT_RETRIED_OFFER_ACK);break;case g.PayloadType.ANSWER_ACK:this.$FBRTCCallSummaryl(o,l.SENT_ANSWER_ACK,l.SENT_RETRIED_ANSWER_ACK);break;case g.PayloadType.ICE_CANDIDATE:this.$FBRTCCallSummarym(n,this.$FBRTCCallSummaryb,this.$FBRTCCallSummaryd);break;default:}this.$FBRTCCallSummaryi();};m.prototype.$FBRTCCallSummarym=function(n,o,p){"use strict";var q=null,r=null,s=this.$FBRTCCallSummaryj.extractIceInfo(n.sdp);for(var t=0;t<s.length;t++){q=s[t].gen;r=s[t].type;if(q===0)this.$FBRTCCallSummaryn(o,r);this.$FBRTCCallSummaryn(p,r);}};m.prototype.$FBRTCCallSummaryn=function(n,o){"use strict";if(!n[o]){n[o]=1;}else n[o]=n[o]+1;};m.prototype.onMessageTypeReceived=function(n){"use strict";var o=n.flag===1;switch(n.type){case g.PayloadType.OFFER:this.$FBRTCCallSummaryl(o,l.RECV_OFFER,l.RECV_RETRIED_OFFER);this.$FBRTCCallSummarym(n,this.$FBRTCCallSummaryc,this.$FBRTCCallSummarye);break;case g.PayloadType.ANSWER:this.$FBRTCCallSummaryl(o,l.RECV_ANSWER,l.RECV_RETRIED_ANSWER);this.$FBRTCCallSummarym(n,this.$FBRTCCallSummaryc,this.$FBRTCCallSummarye);break;case g.PayloadType.OK:this.$FBRTCCallSummaryk(l.RECV_OK);break;case g.PayloadType.PRANSWER:this.$FBRTCCallSummaryk(l.RECV_PRANSWER);break;case g.PayloadType.OFFER_ACK:this.$FBRTCCallSummaryl(o,l.RECV_OFFER_ACK,l.RECV_RETRIED_OFFER_ACK);break;case g.PayloadType.ANSWER_ACK:this.$FBRTCCallSummaryl(o,l.RECV_ANSWER_ACK,l.RECV_RETRIED_ANSWER_ACK);break;case g.PayloadType.ICE_CANDIDATE:this.$FBRTCCallSummarym(n,this.$FBRTCCallSummaryc,this.$FBRTCCallSummarye);break;default:}this.$FBRTCCallSummaryi();};m.prototype.onCallConnected=function(){"use strict";this.$FBRTCCallSummaryk(l.NETWORK_READY);this.$FBRTCCallSummaryk(l.CALL_CONNECTED);this.$FBRTCCallSummaryi();};m.prototype.onCallEnded=function(n,o,p,q){"use strict";this.$FBRTCCallSummary9=p;this.$FBRTCCallSummary4=n;this.$FBRTCCallSummary5=q;this.$FBRTCCallSummary6=o;this.$FBRTCCallSummaryk(l.CALL_ENDED);this.$FBRTCCallSummaryi();};m.prototype.toString=function(){"use strict";var n={};n.core_metrics=this.$FBRTCCallSummaryo();n.time_series=null;return JSON.stringify(n);};m.prototype.$FBRTCCallSummaryo=function(){"use strict";var n={};n.ver=m.CURRENT_SUMMARY_VERSION;n.caller=this.$FBRTCCallSummary0;n.conn=this.$FBRTCCallSummaryp();n.peer_id=this.peerID;n.has_video=true;n.open_count=this.$FBRTCCallSummaryf;n.signaling=this.$FBRTCCallSummaryq();n.sender=this.$FBRTCCallSummaryr();n.receiver=this.$FBRTCCallSummarys();n.end=this.$FBRTCCallSummaryt();n.video=this.$FBRTCCallSummaryu();return n;};m.prototype.$FBRTCCallSummaryp=function(){"use strict";var n={dtls:1};if(this.$FBRTCCallSummarya.sender&&this.$FBRTCCallSummarya.sender.rtt)n.rtt=this.$FBRTCCallSummarya.sender.rtt;return n;};m.prototype.$FBRTCCallSummaryq=function(){"use strict";var n={};if(this.$FBRTCCallSummary2)n.trigger=this.$FBRTCCallSummary2;n.start_time=this.$FBRTCCallSummary1;n.time_from_start=this.$FBRTCCallSummary3;var o=this.$FBRTCCallSummary3[l.CALL_CONNECTED],p=this.$FBRTCCallSummary3[l.CALL_ENDED];if(o){if(!p)if(this.$FBRTCCallSummary8){p=this.$FBRTCCallSummary8-this.$FBRTCCallSummary1;}else p=this.$FBRTCCallSummaryv();var q=p-o;if(q>0)n.duration=q;}return n;};m.prototype.$FBRTCCallSummaryr=function(){"use strict";var n={};if(this.$FBRTCCallSummaryb)n.ice_g0=this.$FBRTCCallSummaryb;if(this.$FBRTCCallSummaryd)n.ice=this.$FBRTCCallSummaryd;if(this.$FBRTCCallSummarya.sender)k(n,this.$FBRTCCallSummarya.sender);return n;};m.prototype.$FBRTCCallSummarys=function(){"use strict";var n={};if(this.$FBRTCCallSummaryc)n.ice_g0=this.$FBRTCCallSummaryc;if(this.$FBRTCCallSummarye)n.ice=this.$FBRTCCallSummarye;return n;};m.prototype.$FBRTCCallSummaryt=function(){"use strict";var n={};if(this.$FBRTCCallSummary4!==null){n.end_call_reason_string=g.callEndReasonString(this.$FBRTCCallSummary4);if(this.$FBRTCCallSummary5!==null)n.end_call_subreason_string=this.$FBRTCCallSummary5;n.remote_ended=this.$FBRTCCallSummary6;}if(this.$FBRTCCallSummarya.end)k(n,this.$FBRTCCallSummarya.end);return n;};m.prototype.$FBRTCCallSummaryu=function(){"use strict";var n={};if(this.$FBRTCCallSummarya.video&&this.$FBRTCCallSummarya.video.sender)k(n,this.$FBRTCCallSummarya.video.sender);return {sender:n};};m.prototype.$FBRTCCallSummaryv=function(){"use strict";return (new Date()).valueOf()-this.$FBRTCCallSummary1;};m.prototype.$FBRTCCallSummaryk=function(n){"use strict";if(this.$FBRTCCallSummary3[n])return;this.$FBRTCCallSummary3[n]=this.$FBRTCCallSummaryv();};m.prototype.$FBRTCCallSummaryl=function(n,o,p){"use strict";if(n){this.$FBRTCCallSummaryk(p);}else this.$FBRTCCallSummaryk(o);};m.prototype.$FBRTCCallSummaryi=function(){"use strict";this.$FBRTCCallSummary7=(new Date()).valueOf();};m.prototype.$FBRTCCallSummaryh=function(){"use strict";return {device:j.deviceName,os:j.platformName,os_version:j.platformFullVersion,browser:j.browserName,browser_version:j.browserFullVersion,screen_height:window.screen.availHeight,screen_width:window.screen.availWidth};};e.exports=m;},null);
__d("FBRTCCallSummaryStore",["CacheStorage","FBRTCCallSummary","FBRTCLogger","areEqual"],function(a,b,c,d,e,f,g,h,i,j){var k='localstorage',l='RTC_CALL_SUMMARY_',m='summary',n=2000,o=3,p=3*60*1000,q=null;r.getInstance=function(){"use strict";if(!q)q=new r();return q;};function r(){"use strict";this.$FBRTCCallSummaryStore0=new g(k,l);this.$FBRTCCallSummaryStore1=i.getInstance();}r.prototype.storeCallSummary=function(s,t,u){"use strict";var v=this;this.$FBRTCCallSummaryStore2(function(w){if(!w[s])w[s]={};var x=w[s][t];if(x){var y=v.$FBRTCCallSummaryStore3(x);if(y&&y.getLastUpdatedTime()>u.getLastUpdatedTime()){v.$FBRTCCallSummaryStore1.logToConsole('Outdated summaries');return null;}}w[s][t]=v.$FBRTCCallSummaryStore4(u);return w;},v.$FBRTCCallSummaryStore1.logError.bind(v.$FBRTCCallSummaryStore1,s,t));};r.prototype.retrieveCallSummary=function(s,t){"use strict";var u=this.$FBRTCCallSummaryStore5(),v=null;if(u[s])v=u[s][t];if(v){return this.$FBRTCCallSummaryStore3(v);}else return null;};r.prototype.removeCallSummary=function(s,t){"use strict";this.removeCallSummaries([{peerID:s,callID:t}]);};r.prototype.removeCallSummaries=function(s){"use strict";var t=this;this.$FBRTCCallSummaryStore2(function(u){var v=s.length;for(var w=0;w<v;w++){var x=s[w].peerID,y=s[w].callID;if(u[x]&&u[x][y]){delete u[x][y];if(t.$FBRTCCallSummaryStore6(u[x]))delete u[x];}}return u;},t.$FBRTCCallSummaryStore1.logError.bind(t.$FBRTCCallSummaryStore1,null,null));};r.prototype.getLoggableSummaries=function(){"use strict";var s=this.$FBRTCCallSummaryStore5(),t=[];for(var u in s)if(s.hasOwnProperty(u))for(var v in s[u])if(s[u].hasOwnProperty(v)){var w=this.$FBRTCCallSummaryStore3(s[u][v],p);if(w)t.push(w);}return t;};r.prototype.$FBRTCCallSummaryStore6=function(s){"use strict";for(var t in s)if(s.hasOwnProperty(t))return false;return true;};r.prototype.$FBRTCCallSummaryStore4=function(s){"use strict";var t={__t:Date.now(),__d:s.toJsonString()};return t;};r.prototype.$FBRTCCallSummaryStore3=function(s,t){"use strict";if(s)if(!t||(Date.now()-s.__t>=t))return h.fromJsonString(s.__d);return null;};r.prototype.$FBRTCCallSummaryStore5=function(){"use strict";var s=this.$FBRTCCallSummaryStore0.get(m)||{};return s;};r.prototype.$FBRTCCallSummaryStore2=function(s,t,u,v){"use strict";if(u===(void 0)||u===null)u=o;var w=this.$FBRTCCallSummaryStore5(),x=this.$FBRTCCallSummaryStore5(),y=s(w);if(y===null)return;var z=this.$FBRTCCallSummaryStore5();if(j(x,z)){this.$FBRTCCallSummaryStore0.set(m,y);this.$FBRTCCallSummaryStore1.logToConsole('Updated summaries');}else if(u>0){t('Retry lock');if(v){var aa=this;setTimeout(function(){aa.$FBRTCCallSummaryStore2(s,t,u-1,true);},n);}else this.$FBRTCCallSummaryStore2(s,t,u-1,true);}else t('Failed to lock');};e.exports=r;},null);
__d("XVideoCallControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){e.exports=b("XControllerURIBuilder").create("\/videocall\/incall\/",{peer_id:{type:"Int",required:true},call_id:{type:"Int"},is_caller:{type:"Bool"}});},null);
__d("FBRTCCallUI",["Cookie","FBRTCCallSummary","FBRTCCallSummaryStore","FBRTCConstants","FBRTCLogger","XVideoCallControllerURIBuilder"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m={openAsCaller:function(n,o,p){k.getInstance().logCallAction(n,o,k.CallAction.START_CALL,null,p);var q=new h({peerID:n,callID:o,isCaller:true});q.onCallStarted(p);this._open(n,o,true,q);},openAsCallee:function(n,o,p){this._open(n,o,false,p);},_open:function(n,o,p,q){g.clear('vcpwn');g.clear('vctid');var r=new l().setInt('peer_id',n).setInt('call_id',o).setBool('is_caller',p).getURI(),s=this._windowPosition(),t=['menubar=no','location=no','scrollbars=no','status=no','personalbar=no',s.height,s.width,s.top,s.left].join(',');q.onCallEnded(j.CallEndReason.CLIENT_ERROR,false,true,'PopupPending');q.save(i.getInstance());k.getInstance().logCallAction(n,o,k.CallAction.OPEN_POPUP);var u=window.open(r,'Video Call',t);if(window.focus)u.focus();},_windowPosition:function(){var n=933,o=700,p,q,r,s;if(window.innerWidth!==(void 0)){q=window.innerWidth;p=window.innerHeight;}else{q=screen.width;p=screen.height;}if(window.screenLeft!==(void 0)){r=window.screenLeft;s=window.screenTop;}else{r=window.screenX;s=window.screenY;}var t=Math.floor(((q/2)-(n/2))+r),u=Math.floor(((p/2)-(o/2))+s);return {height:'height='+o.toString(),width:'width='+n.toString(),top:'top='+u.toString(),left:'left='+t.toString()};}};e.exports=m;},null);
__d("FBRTCIceCache",[],function(a,b,c,d,e,f){function g(){"use strict";this.$FBRTCIceCache0={};}g.prototype.cacheCandidate=function(h,i,j){"use strict";if(!this.$FBRTCIceCache0[h])this.$FBRTCIceCache0[h]=[];if(!this.$FBRTCIceCache0[h][i])this.$FBRTCIceCache0[h][i]=[];this.$FBRTCIceCache0[h][i].unshift(j);};g.prototype.drainCandidates=function(h,i,j){"use strict";if(this.$FBRTCIceCache0[h]&&this.$FBRTCIceCache0[h][i]){var k;while(this.$FBRTCIceCache0[h][i].length>0){k=this.$FBRTCIceCache0[h][i].pop();j(k);}}};e.exports=g;},null);
__d("XIncomingCallDialogControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){e.exports=b("XControllerURIBuilder").create("\/videocall\/incoming\/",{user_id:{type:"Int",required:true},__asyncDialog:{type:"Int"}});},null);
__d("FBRTCSoundController",["ChatConfig","Sound"],function(a,b,c,d,e,f,g,h){var i=[g.get('sound.ringtone_mp3_url'),g.get('sound.ringtone_ogg_url')],j={playIncomingRingtone:function(k,l,m){var n=['incoming_ringtone',k.toString(),l.toString()].join('_');h.play(i,n,m);},stopIncomingRingtone:function(){h.stop(i);}};e.exports=j;},null);
__d("FBRTCIncomingCall",["AsyncDialog","AsyncRequest","Dialog","MissedVideoCallHandler","setTimeoutAcrossTransitions","XIncomingCallDialogControllerURIBuilder","FBRTCSoundController"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=70000;function o(p,q,r,s){"use strict";this.peerID=p;this.callID=q;this.callSummary=r;this.offerMsg=s;this.ringing=false;this.$FBRTCIncomingCall0=null;}o.prototype.showIncomingDialog=function(){"use strict";var p=i.getCurrent();if(p)p.hide();j.setSuppressAll(true);this.ringing=true;this.timeout=k(this.$FBRTCIncomingCall1.bind(this),n);var q=new l().setInt('user_id',this.peerID).getURI();this.$FBRTCIncomingCall0=new h(q);g.send(this.$FBRTCIncomingCall0,this.$FBRTCIncomingCall2.bind(this));};o.prototype.$FBRTCIncomingCall2=function(p){"use strict";this.$FBRTCIncomingCall0=null;this.view=p;p.subscribe('confirm',this.$FBRTCIncomingCall3.bind(this));p.subscribe('cancel',this.$FBRTCIncomingCall4.bind(this));m.playIncomingRingtone(this.callID,this.peerID,true);j.setSuppressAll(false);};o.prototype.cancel=function(){"use strict";if(this.$FBRTCIncomingCall0){this.$FBRTCIncomingCall0.abort();this.$FBRTCIncomingCall0=null;}if(this.timeout)clearTimeout(this.timeout);if(this.view){this.view.hide();this.view=null;}m.stopIncomingRingtone();this.ringing=false;};o.prototype.isForPeer=function(p){"use strict";return this.peerID===p;};o.prototype.isForPeerAndCall=function(p,q){"use strict";return (this.peerID===p)&&(this.callID===q);};o.prototype.$FBRTCIncomingCall3=function(){"use strict";this.cancel();if(this.onAnswer)this.onAnswer(this.peerID,this.callID,this.offerMsg,this.callSummary);};o.prototype.$FBRTCIncomingCall4=function(){"use strict";this.cancel();if(this.onIgnore)this.onIgnore(this.peerID,this.callID,this.callSummary);};o.prototype.$FBRTCIncomingCall1=function(){"use strict";this.cancel();if(this.onTimeout)this.onTimeout(this.peerID,this.callID,this.callSummary);};e.exports=o;},null);
__d("FBRTCLocalMessageQueue",["CacheStorage","FBRTCLogger","randomInt"],function(a,b,c,d,e,f,g,h,i){var j='localstorage',k='RTC_',l='offer',m='data_',n='last_write_index',o='session_id',p=30*1000,q=20*1000,r=15*1000,s=500;function t(){"use strict";this.$FBRTCLocalMessageQueue0=null;this.$FBRTCLocalMessageQueue1=null;this.$FBRTCLocalMessageQueue2=null;this.$FBRTCLocalMessageQueue3=null;this.$FBRTCLocalMessageQueue4=null;this.$FBRTCLocalMessageQueue5=h.getInstance();}t.prototype.enqueueOffer=function(u,v){"use strict";var w=this.$FBRTCLocalMessageQueue6(u);this.$FBRTCLocalMessageQueue7(w,l,v);};t.prototype.getOffer=function(u){"use strict";var v=this.$FBRTCLocalMessageQueue6(u);return this.$FBRTCLocalMessageQueue8(v,l);};t.prototype.removeOffer=function(u){"use strict";var v=this.$FBRTCLocalMessageQueue6(u);v.remove(l);};t.prototype.maybeEnqueueMessage=function(u,v,w){"use strict";if(!this.$FBRTCLocalMessageQueue9(u))return;var x=this.$FBRTCLocalMessageQueue6(u),y=x.get(n)||0;y++;x.set(n,y,true);var z=m+y.toString();this.$FBRTCLocalMessageQueue7(x,z,w);this.$FBRTCLocalMessageQueue5.logToConsole('Queued '+z);};t.prototype.enableEnqueuing=function(u,v,w){"use strict";this.$FBRTCLocalMessageQueue5.logInfo(u,v,'Enabled enqueuing');if(this.$FBRTCLocalMessageQueue1)clearTimeout(this.$FBRTCLocalMessageQueue1);if(w===(void 0))w=q;if(this.$FBRTCLocalMessageQueue0!==u){var x=this.$FBRTCLocalMessageQueue6(u);this.$FBRTCLocalMessageQueue0=u;x.set(n,0,true);x.set(o,i(0,4294967295),true);}var y=this;this.$FBRTCLocalMessageQueue1=setTimeout(function(){y.$FBRTCLocalMessageQueue5.logInfo(u,v,'Disabled enqueuing');y.$FBRTCLocalMessageQueue0=null;y.$FBRTCLocalMessageQueue1=null;},w);};t.prototype.enableDequeuing=function(u,v,w){"use strict";if(w===(void 0))w=r;this.$FBRTCLocalMessageQueuea(u,v,w);};t.prototype.$FBRTCLocalMessageQueuea=function(u,v,w){"use strict";var x=this.$FBRTCLocalMessageQueue6(u),y=x.get(o);if(y!==this.$FBRTCLocalMessageQueue4){this.$FBRTCLocalMessageQueue4=y;this.$FBRTCLocalMessageQueue3=0;}var z=x.get(n)||0,aa=0;while(this.$FBRTCLocalMessageQueue3<z){this.$FBRTCLocalMessageQueue3++;var ba=m+this.$FBRTCLocalMessageQueue3.toString(),ca=this.$FBRTCLocalMessageQueueb(x,ba);if(ca&&v){v(ca);aa++;}}this.$FBRTCLocalMessageQueue5.logToConsole('Dequeued '+aa+' ('+u+') with '+w+' left)');if(w>0){var da=this;this.$FBRTCLocalMessageQueue2=setTimeout(da.$FBRTCLocalMessageQueuea.bind(da,u,v,w-s),s);}else{this.$FBRTCLocalMessageQueue2=null;this.$FBRTCLocalMessageQueue3=null;this.$FBRTCLocalMessageQueue4=null;}};t.prototype.$FBRTCLocalMessageQueue9=function(u){"use strict";return (this.$FBRTCLocalMessageQueue0===u);};t.prototype.$FBRTCLocalMessageQueue7=function(u,v,w){"use strict";var x={__t:Date.now(),__d:w};u.set(v,x);};t.prototype.$FBRTCLocalMessageQueue8=function(u,v){"use strict";var w=u.get(v);if(w&&this.$FBRTCLocalMessageQueuec(w)){return w.__d;}else if(w)u.remove(v);return null;};t.prototype.$FBRTCLocalMessageQueueb=function(u,v){"use strict";var w=this.$FBRTCLocalMessageQueue8(u,v);if(w!==null){u.remove(v);return w;}return null;};t.prototype.$FBRTCLocalMessageQueuec=function(u){"use strict";return Date.now()-u.__t<p;};t.prototype.$FBRTCLocalMessageQueue6=function(u){"use strict";return new g(j,k+u+'_');};e.exports=t;},null);
__d("FBRTCMessageDedup",[],function(a,b,c,d,e,f){var g={},h={check:function(i,j,k){if(!g[i])g[i]={};if(!g[i][j])g[i][j]={};if(g[i][j][k])return false;g[i][j][k]=true;return true;}};e.exports=h;},null);
__d("XVideoCallSendMessageControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){e.exports=b("XControllerURIBuilder").create("\/videocall\/sendmessage\/",{recipient_id:{type:"Int",required:true},msg_id:{type:"Int",required:true},message_info:{type:"String",required:true}});},null);
__d("FBRTCUtils",["emptyFunction","randomInt","AsyncRequest"],function(a,b,c,d,e,f,g,h,i){var j=6000,k={attachMediaStream:function(l,m){if(window.webkitRTCPeerConnection){l.src=window.webkitURL.createObjectURL(m);}else{l.mozSrcObject=m;l.play();}},reattachMediaStream:function(l,m){if(window.webkitRTCPeerConnection){l.src=m.src;}else{l.mozSrcObject=m.mozSrcObject;l.play();}},generateRandomInt:function(){return h(0,4294967294)+1;},aboutEqual:function(l,m){return (l-m)<.01&&(m-l)<.01;},sendServerRequest:function(l,m,n,o){m=m||g;n=n||g;o=o||false;var p=new i().setURI(l).setAllowCrossPageTransition(true).setHandler(m).setErrorHandler(n).setTimeoutHandler(j,function(){n();});if(o)p.setOption('asynchronous',false);p.send();}};e.exports=k;},null);
__d("FBRTCMessageSender",["CurrentUser","XVideoCallSendMessageControllerURIBuilder","FBRTCConstants","FBRTCLogger","FBRTCUtils"],function(a,b,c,d,e,f,g,h,i,j,k){var l=0;function m(){"use strict";this.onSendFailure=null;this.$FBRTCMessageSender0=j.getInstance();}m.prototype.sendOffer=function(n,o,p,q){"use strict";var r=this.$FBRTCMessageSender1(o,i.PayloadType.OFFER);r.sdp=p;r.handlescollision=true;r.videoon=q;this.$FBRTCMessageSender2(n,r);return this.$FBRTCMessageSender3(n,r);};m.prototype.sendAnswer=function(n,o,p,q){"use strict";var r=this.$FBRTCMessageSender1(o,i.PayloadType.ANSWER);r.sdp=p;r.videoon=q;this.$FBRTCMessageSender2(n,r);return this.$FBRTCMessageSender3(n,r);};m.prototype.sendIceCandidate=function(n,o,p){"use strict";var q=this.$FBRTCMessageSender1(o,i.PayloadType.ICE_CANDIDATE);q.sdp_mid=p.sdpMid;q.label=p.sdpMLineIndex;q.sdp=p.candidate;this.$FBRTCMessageSender4(n,q);};m.prototype.sendHangup=function(n,o,p,q){"use strict";var r=this.$FBRTCMessageSender1(o,i.PayloadType.HANGUP);r.reason=p;this.$FBRTCMessageSender4(n,r,q);};m.prototype.sendOtherDismiss=function(n){"use strict";var o=this.$FBRTCMessageSender1(n,i.PayloadType.OTHER_DISMISS);this.$FBRTCMessageSender4(g.getID(),o);};m.prototype.sendOfferAck=function(n,o,p){"use strict";this.$FBRTCMessageSender5(n,o,p,i.PayloadType.OFFER_ACK);};m.prototype.sendOfferNack=function(n,o,p){"use strict";this.$FBRTCMessageSender5(n,o,p,i.PayloadType.OFFER_NACK,1356043);};m.prototype.sendAnswerAck=function(n,o,p){"use strict";this.$FBRTCMessageSender5(n,o,p,i.PayloadType.ANSWER_ACK);};m.prototype.sendIcerestartOffer=function(n,o,p){"use strict";var q=this.$FBRTCMessageSender1(o,i.PayloadType.ICERESTART_OFFER);q.sdp=p;q.handlescollision=true;q.icerestart=true;this.$FBRTCMessageSender2(n,q);return this.$FBRTCMessageSender3(n,q);};m.prototype.sendMuteStateUpdate=function(n,o,p){"use strict";var q=this.$FBRTCMessageSender1(o,i.PayloadType.SET_VIDEO);q.videoon=p;this.$FBRTCMessageSender4(n,q);};m.prototype.sendMsgAck=function(){"use strict";};m.prototype.sendOk=function(){"use strict";};m.prototype.sendPranswer=function(){"use strict";};m.prototype.sendIcerestartAnswer=function(){"use strict";};m.prototype.$FBRTCMessageSender1=function(n,o){"use strict";var p=k.generateRandomInt(),q={version:l,type:o,call_id:n,msg_id:p};return q;};m.prototype.$FBRTCMessageSender3=function(n,o){"use strict";o.flag=1;return this.$FBRTCMessageSender2.bind(this,n,o);};m.prototype.$FBRTCMessageSender2=function(n,o){"use strict";this.$FBRTCMessageSender4(n,o,false,true,true);};m.prototype.$FBRTCMessageSender5=function(n,o,p,q,r){"use strict";var s=this.$FBRTCMessageSender1(o,q);s.ack_id=p.msg_id;if(p.flag===1)s.flag=1;if(r!==(void 0))p.errorCode=r;this.$FBRTCMessageSender4(n,s);};m.prototype.$FBRTCMessageSender4=function(n,o,p,q,r){"use strict";var s=o.msg_id,t={peer_id:n,call_id:o.call_id,msg_id:s,msg_type:o.type},u=(new h()).setInt('recipient_id',n).setInt('msg_id',s).setString('message_info',JSON.stringify(o)).getURI();if(q)var v=this.$FBRTCMessageSender4.bind(this,n,o,p,false,r);k.sendServerRequest(u,this.$FBRTCMessageSender6.bind(this,t),this.$FBRTCMessageSender7.bind(this,t,v,r),p);if(this.onMessageSent)this.onMessageSent(n,o);this.$FBRTCMessageSender0.logSentMessage(n,o.call_id,o);};m.prototype.$FBRTCMessageSender6=function(n){"use strict";this.$FBRTCMessageSender0.logSentMessageSuccess(n.peer_id,n.call_id,n.msg_type,n.msg_id);};m.prototype.$FBRTCMessageSender7=function(n,o,p,q){"use strict";if(q)var r=q.getError?q.getError():q;this.$FBRTCMessageSender0.logSentMessageFailure(n.peer_id,n.call_id,n.msg_type,n.msg_id,r);if(this.onSendFailure){var s=null;if(r===1356001||r===1356049){s=i.CallEndReason.NO_PERMISSION;}else if(r===1356046||r===1356045){s=i.CallEndReason.CALLER_NOT_VISIBLE;}else if(r===1356003||r===1356002||r===1356044||r===1356048){s=i.CallEndReason.OTHER_NOT_CAPABLE;}else if(o){o();return;}else if(p)s=i.CallEndReason.SIGNALING_MESSAGE_FAILED;if(s)this.onSendFailure(s,r);}};e.exports=m;},null);
__d("XVideoCallMissedCallControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){e.exports=b("XControllerURIBuilder").create("\/videocall\/missed_call\/",{user_id:{type:"Int",required:true},__asyncDialog:{type:"Int"}});},null);
__d("FBRTCMissedVideoCallHandler",["AsyncDialog","AsyncRequest","FBRTCLogger","MissedVideoCallHandler","VideoCallSupport","XVideoCallMissedCallControllerURIBuilder"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=null,n=null;o.hideDialog=function(){"use strict";if(m){m.hide();m=null;n=null;j.setSuppressAll(false);}};function o(p){"use strict";this.$FBRTCMissedVideoCallHandler0=p;this.$FBRTCMissedVideoCallHandler1=null;}o.prototype.onCallMissed=function(p){"use strict";if(!k.isWebrtcSupported())return;if(n===null)this.$FBRTCMissedVideoCallHandler1=p;};o.prototype.showDialog=function(){"use strict";if(!this.$FBRTCMissedVideoCallHandler1||n)return;j.setSuppressAll(true);n=this.$FBRTCMissedVideoCallHandler1;this.$FBRTCMissedVideoCallHandler1=null;var p=new l().setInt('user_id',n).getURI(),q=new h(p);g.send(q,this.$FBRTCMissedVideoCallHandler2.bind(this));};o.prototype.$FBRTCMissedVideoCallHandler2=function(p){"use strict";m=p;p.subscribe('confirm',this.$FBRTCMissedVideoCallHandler3.bind(this));p.subscribe('cancel',this.$FBRTCMissedVideoCallHandler4.bind(this));};o.prototype.$FBRTCMissedVideoCallHandler3=function(){"use strict";this.$FBRTCMissedVideoCallHandler0.showOutgoingCallDialog(n,'missed_call_dialog',i.Trigger.RETURN_CALL);o.hideDialog();};o.prototype.$FBRTCMissedVideoCallHandler4=function(){"use strict";o.hideDialog();};e.exports=o;},null);
__d("XBrowserNotSupportedDialogControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){e.exports=b("XControllerURIBuilder").create("\/videocall\/browser_not_supported\/",{user_id:{type:"Int"},__asyncDialog:{type:"Int"}});},null);
__d("FBRTCUnsupportedBrowserMessage",["AsyncDialog","AsyncRequest","XBrowserNotSupportedDialogControllerURIBuilder","FBRTCSoundController"],function(a,b,c,d,e,f,g,h,i,j){var k={_dialog:null,showForOutgoingCall:function(){var l=new i().getURI();this._presentDialog(l);},showForIncomingCall:function(l,m){j.playIncomingRingtone(l,m,false);var n=new i().setInt('user_id',m).getURI();this._presentDialog(n);},dismiss:function(){if(this._dialog)this._dialog.hide();},_presentDialog:function(l){if(this._dialog)return;var m=new h(l),n=this;g.send(m,function(o){n._dialog=o;o.subscribe('hide',n._dialogHidden.bind(n));});},_dialogHidden:function(){this._dialog=null;}};e.exports=k;},null);
__d("FBRTCIncomingCallController",["Banzai","FBRTCCallSummary","FBRTCCallSummaryStore","FBRTCCallUI","FBRTCConstants","FBRTCIceCache","FBRTCIncomingCall","FBRTCLocalMessageQueue","FBRTCLogger","FBRTCMessageDedup","FBRTCMessageSender","FBRTCMissedVideoCallHandler","FBRTCUnsupportedBrowserMessage","VideoCallSupport"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){function u(v){"use strict";this.$FBRTCIncomingCallController0=null;this.$FBRTCIncomingCallController1=new r(v);this.$FBRTCIncomingCallController2=new q();this.$FBRTCIncomingCallController3=new n();this.$FBRTCIncomingCallController4=i.getInstance();this.$FBRTCIncomingCallController5=new l();this.$FBRTCIncomingCallController6=o.getInstance();v.setRTCMessageHandler(this.$FBRTCIncomingCallController7.bind(this));g.subscribe(g.SEND,h.logSavedSummaries.bind(this,this.$FBRTCIncomingCallController4));}u.prototype.startingCallTo=function(v,w){"use strict";this.$FBRTCIncomingCallController3.enableEnqueuing(v,w);};u.prototype.$FBRTCIncomingCallController7=function(v){"use strict";if(!v.payload||!v.call_id||!v.from){this.$FBRTCIncomingCallController6.logErrorWithoutID('Unknown data: '+JSON.stringify(v));return;}var w=v.from,x=parseInt(v.call_id,10),y=JSON.parse(v.payload),z=y.type;if(!p.check(w,x,y.msg_id)){this.$FBRTCIncomingCallController6.logInfo(w,x,'Ignoring message (duplicate): '+y.msg_id);return;}this.$FBRTCIncomingCallController6.logReceivedMessage(w,x,y);if(t.isWebrtcSupported())this.$FBRTCIncomingCallController3.maybeEnqueueMessage(w,x,v);switch(z){case k.PayloadType.OFFER:this.$FBRTCIncomingCallController8(w,x,y);break;case k.PayloadType.HANGUP:this.$FBRTCIncomingCallController9(w,x,y);break;case k.PayloadType.OTHER_DISMISS:this.$FBRTCIncomingCallControllera();break;case k.PayloadType.ICE_CANDIDATE:if(t.isWebrtcSupported())this.$FBRTCIncomingCallController5.cacheCandidate(w,x,v);break;case k.PayloadType.OFFER_ACK:if(t.isWebrtcSupported()){this.$FBRTCIncomingCallController3.enableEnqueuing(w,x);this.$FBRTCIncomingCallController3.maybeEnqueueMessage(w,x,v);}break;case k.PayloadType.ANSWER:case k.PayloadType.MSG_ACK:case k.PayloadType.OK:case k.PayloadType.PRANSWER:case k.PayloadType.ICERESTART_OFFER:case k.PayloadType.ICERESTART_ANSWER:case k.PayloadType.ANSWER_ACK:case k.PayloadType.SET_VIDEO:case k.PayloadType.OFFER_NACK:break;default:break;}};u.prototype.$FBRTCIncomingCallController8=function(v,w,x){"use strict";if(t.isWebrtcSupported()){this.$FBRTCIncomingCallController2.sendOfferAck(v,w,x);}else this.$FBRTCIncomingCallController2.sendOfferNack(v,w,x);this.$FBRTCIncomingCallController6.logCallAction(v,w,o.CallAction.RECEIVED_CALL);var y=this.$FBRTCIncomingCallControllerb(v,w,x);if(this.$FBRTCIncomingCallController0!==null&&!this.$FBRTCIncomingCallController0.isForPeer(v)){this.$FBRTCIncomingCallControllerc(v,w,y,k.CallEndReason.IN_ANOTHER_CALL,false,false,true);this.$FBRTCIncomingCallController1.onCallMissed(v);return;}if(!t.isWebrtcSupported()){this.$FBRTCIncomingCallControllerc(v,w,y,k.CallEndReason.UNSUPPORTED_VERSION,false,false,false);s.showForIncomingCall(w,v);return;}this.$FBRTCIncomingCallController0=new m(v,w,y,x);this.$FBRTCIncomingCallController0.onAnswer=this.$FBRTCIncomingCallControllerd.bind(this);this.$FBRTCIncomingCallController0.onIgnore=this.$FBRTCIncomingCallControllere.bind(this);this.$FBRTCIncomingCallController0.onTimeout=this.$FBRTCIncomingCallControllerf.bind(this);r.hideDialog();this.$FBRTCIncomingCallController0.showIncomingDialog();this.$FBRTCIncomingCallController6.logEvent(v,w,'Incoming call dialog shown');};u.prototype.$FBRTCIncomingCallController9=function(v,w,x){"use strict";if(this.$FBRTCIncomingCallController0&&this.$FBRTCIncomingCallController0.isForPeerAndCall(v,w)){this.$FBRTCIncomingCallController0.cancel();this.$FBRTCIncomingCallControllerc(v,w,this.$FBRTCIncomingCallController0.callSummary,x.reason,true,true,false);this.$FBRTCIncomingCallController0.cancel();this.$FBRTCIncomingCallController0=null;if(x.reason!==k.CallEndReason.OTHER_INSTANCE_HANDLED){this.$FBRTCIncomingCallController1.onCallMissed(v);this.$FBRTCIncomingCallController1.showDialog();}}};u.prototype.$FBRTCIncomingCallControllera=function(){"use strict";s.dismiss();if(this.$FBRTCIncomingCallController0){this.$FBRTCIncomingCallController0.cancel();this.$FBRTCIncomingCallController0=null;}};u.prototype.$FBRTCIncomingCallControllerb=function(v,w,x){"use strict";var y=new h({peerID:v,callID:w,isCaller:false});y.onMessageTypeReceived(x);y.onOfferAckSent(x);return y;};u.prototype.$FBRTCIncomingCallControllerd=function(v,w,x,y){"use strict";this.$FBRTCIncomingCallController6.logCallAction(v,w,o.CallAction.ANSWER_CALL);this.$FBRTCIncomingCallController2.sendOtherDismiss(w);this.$FBRTCIncomingCallController3.enableEnqueuing(v,w);this.$FBRTCIncomingCallController3.enqueueOffer(v,x);var z=this;this.$FBRTCIncomingCallController5.drainCandidates(v,w,function(aa){z.$FBRTCIncomingCallController3.maybeEnqueueMessage(v,w,aa);});j.openAsCallee(v,w,y);this.$FBRTCIncomingCallController0=null;this.$FBRTCIncomingCallController1.showDialog();};u.prototype.$FBRTCIncomingCallControllere=function(v,w,x){"use strict";this.$FBRTCIncomingCallControllerc(v,w,x,k.CallEndReason.IGNORE_CALL,false,true,true);this.$FBRTCIncomingCallController0=null;this.$FBRTCIncomingCallController1.showDialog();};u.prototype.$FBRTCIncomingCallControllerf=function(v,w,x){"use strict";this.$FBRTCIncomingCallControllerc(v,w,x,k.CallEndReason.NO_ANSWER_TIMEOUT,false,true,true);this.$FBRTCIncomingCallController0=null;this.$FBRTCIncomingCallController1.onCallMissed(v);this.$FBRTCIncomingCallController1.showDialog();};u.prototype.$FBRTCIncomingCallControllerc=function(v,w,x,y,z,aa,ba){"use strict";if(ba)this.$FBRTCIncomingCallController2.sendHangup(v,w,y);if(aa)this.$FBRTCIncomingCallController2.sendOtherDismiss(w);x.onCallEnded(y,z);x.save(this.$FBRTCIncomingCallController4);var ca=k.fullCallEndReasonString(y,z);this.$FBRTCIncomingCallController6.logCallAction(v,w,o.CallAction.END_CALL,ca);};e.exports=u;},null);